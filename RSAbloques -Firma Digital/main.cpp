#include "rsa.h"
#include <NTL/ZZ.h>
#include <iostream>
#include <string>
#include <vector>
#include "mathfunc.h"
#include <sstream>

using namespace std;
using namespace NTL;

int main()
{
    // Claves de receptor
    RSABloques receptor(1024);
    RSABloques emisor(Stringtozz("8993235106059175490907231911073194789527965048737049515644089490566723457814666282931631996542610373647510933854030458247453840083496137282476866460310692065479352827516888583155288079929865244087139121483121303456541866675207802512967458524652809795128543793993810296510644551510437829738320007629028883150535236319588022115817667752467949995459349331660193229321411014818272250451857017780143226827514465018963678036574457183817277614706584717899606048959748370648287974002624746677614390143065733697762087930414696624680486842462161965303445327609478374521512255929187086923142856268292525972947660863705123185861"),
                      Stringtozz("106601887332519271897775278561330170118468462854281722221991411617178068605882841623549458334246176858252639503652546149413512565714101115575526613574324082296853430563589076117210756888399315312729150544551398984309780990184909305632453848820363569752750584298905512188685540233737817719100170759844227175713"),
                      Stringtozz("125866037920804015347508412704303851247714234534847597053613649172505116308672052833790771288482719389788423516791055256865614325825725975190223126365676170717439671845082035983003288895855213292100300388448231585060319685004889808510264234125954596182963868213680907863137680379879222337098850211299240686871"));

    emisor.eB=receptor.e;
    emisor.NB=receptor.N;

    receptor.eB=emisor.e;
    receptor.NB=emisor.N;

    string cifrado, descifrado;
    string msn = "IREMEMBERITWASLATEONENIGHTINTHEMIDDLEOFADREAMWOKEUPINAPOOLOFSWEATTHOUGHTIHEARDASCREAMRANOVERTOTHEWINDOWSPEEKDRESSEDINBLACKWASAMANIDIDNTRECOGNISERUNNINGDOWNMYBACKSTREETMYHEARTSKIPPEDABEAT";

    cifrado = emisor.cifrar(msn);
    cout << cifrado <<endl<<endl;

    descifrado = receptor.descifrar(cifrado);
    cout << descifrado <<endl;

}
